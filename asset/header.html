<header class="site-header">
  <div class="header-left">
    <img src="/barng.github.io/asset/self_picture.png" alt="Profile Picture" class="profile-pic" />
    <div id="language-switcher-container"></div> 
  </div>

  <nav class="main-nav">
    <ul>
      <li><a href="/barng.github.io/index.html" id="home-link">Home</a></li>
      <li><a href="/barng.github.io/pages/education.html" id="education-link">Education</a></li>
      <li><a href="/barng.github.io/pages/skill.html" id="skills-link">Skills</a></li>
      <li><a href="/barng.github.io/pages/experience.html" id="experience-link">Experiences</a></li>
      <li><a href="/barng.github.io/pages/projects.html" id="projects-link">Projects</a></li>
      <li><a href="/barng.github.io/pages/references.html" id="references-link">References</a></li>
      <li><a href="/barng.github.io/pages/sub_job.html" id="others-link">Others</a></li>
    </ul>
  </nav>
</header>
  
<script>
  // ヘッダーを動的に読み込み、その後言語スイッチャーを読み込む
  fetch('/barng.github.io/asset/header.html')
      .then(response => response.text())
      .then(data => {
          document.getElementById('header-placeholder').innerHTML = data;
          // header.htmlの読み込みが完了した後に、その中のコンテナにlanguage_switcher.htmlを読み込む
          return fetch('/barng.github.io/asset/language_switcher.html');
      })
      .then(response => response.text())
      .then(data => {
          // header.html内に作成した専用のコンテナに挿入する
          const switcherContainer = document.getElementById('language-switcher-container');
          if (switcherContainer) {
              switcherContainer.innerHTML = data;
          }
          
          // ここで言語切り替えの初期化やイベントリスナーを設定するのが望ましい
          // 元のheader.htmlにあったスクリプトのロジックをここに統合する
          const initialLang = localStorage.getItem('selectedLanguage') || 'en';
          const selectElement = document.querySelector('#language-switcher-container select');
          if (selectElement) {
              selectElement.value = initialLang;
              // changeLanguage関数を呼び出す（index.html内の関数が使われる）
              changeLanguage(initialLang); 

              selectElement.addEventListener('change', function () {
                  const selectedLang = this.value;
                  localStorage.setItem('selectedLanguage', selectedLang);
                  // メインコンテンツと言語スイッチャー自身の両方の言語を変更
                  changeLanguage(selectedLang); 
              });
          }
      })
      .catch(error => console.error('Error loading assets:', error));
  // Language Data (keep this in header.html if you want header.html to manage language switching for itself)
  const languageData = {
    en: {
      resumeTitle: "Resume & Career",
      home: "Home",
      education: "Education",
      skills: "Skills",
      experience: "Experiences",
      projects: "Projects",
      references: "References",
      others: "Others"
    },
    jp: {
      resumeTitle: "履歴書及び職務経歴書",
      home: "ホーム",
      education: "学歴",
      skills: "スキル",
      experience: "職歴",
      projects: "プロジェクト",
      references: "参考文献",
      others: "その他"
    },
    kr: {
      resumeTitle: "이력서 및 직무 경력서",
      home: "홈",
      education: "학력",
      skills: "스킬",
      experience: "직무경험",
      projects: "프로젝트",
      references: "기타활동",
      others: "기타"
    }
  };

  function changeLanguage(lang) {
    // Update header elements
    document.getElementById('resume-title').textContent = languageData[lang].resumeTitle;
    document.getElementById('home-link').textContent = languageData[lang].home;
    document.getElementById('education-link').textContent = languageData[lang].education;
    document.getElementById('skills-link').textContent = languageData[lang].skills;
    document.getElementById('experience-link').textContent = languageData[lang].experience;
    document.getElementById('projects-link').textContent = languageData[lang].projects;
    document.getElementById('references-link').textContent = languageData[lang].references;
    document.getElementById('others-link').textContent = languageData[lang].others;

    // If you want to update content on the main page, you'll need to dispatch a custom event
    // or have a global function that main page scripts can listen to/call.
    // For simplicity here, we assume header only changes its own elements.
    // For the main page content, the language switching logic in index.html (currently commented out)
    // would need to be active and properly integrated.
  }

  // Initial language setting for the header when loaded
  window.addEventListener('DOMContentLoaded', () => {
    const initialLang = localStorage.getItem('selectedLanguage') || 'jp'; // Or default to 'jp' if preferred
    const selectElement = document.querySelector('#language-switcher-actual select');
    if (selectElement) {
      selectElement.value = initialLang;
      changeLanguage(initialLang); // Apply initial language
    }
  });

</script>